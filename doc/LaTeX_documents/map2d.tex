\ProvidesFile{map2d.tex}[v1.0.6]
\startObject{\objNameS{map2d}}{map2d}
\index{Themes!Programming~aids!map2d}
\objPicture{map2dsymbol.ps}
\objItemDescription{\objNameD{map2d} maps its input to a one of a sequence of ranges and returns the set of
values associated with the range.}

\objItemCreated{November 2000}

\objItemVersion{1.0.6}

\objItemHelp{yes}

\objItemTheme{Programming aids}

\objItemClass{Arith/Logic/Bitwise, Lists}

\objItemArgs{\nothing}

  \objListArgBegin
  \objListArgItem{init-file}{(optional) symbol}{the name of the map file to load initially}
  \objListArgEnd

\objItemInlet{\nothing}

  \objListIOBegin
  \objListIOItem{list}{the command or data input}
  \objListIOEnd

\objItemOutlet{\nothing}

  \objListIOBegin
  \objListIOItem{list}{the retrieved data, the previous result (if a \objCmdQ{bang} is received),
  the number of loaded ranges, the description of an individual range or the value of an element
  of a range.
  Results or retrieved data appear as a list starting with the symbol `result';
  the number of loaded ranges appear as a two element list, starting with the symbol `count',
  range descriptions appear as a list starting with the symbol `range' and range element values
  appear as a list starting with the symbol `value'.}
  \objListIOEnd

\objItemCompanion{none}

\objItemStandalone{yes}

\objItemRetainsState{yes}

\objItemCompatibility{\MaxName{} 3.x and \MaxName{} 4.x \{OS 9 and OS X\}}

\objItemFat{Fat}

\objItemCommands[]

  \objListCmdBegin

  \objListCmdItem{add}{list}
  Add a range to the end of the loaded set of ranges.
  The range is in the form: \emphcorr{`*'} or \emphcorr{bracket1 left right bracket2} \emphcorr{`*'} or \emphcorr{bracket3 bottom top bracket4 output}, where
  \emphcorr{bracket1} and \emphcorr{bracket3} are either `[' or `(' and \emphcorr{bracket2} and \emphcorr{bracket4} are
  either `]' or `)';
  \emphcorr{left} and \emphcorr{bottom} are floating-point numbers, integers or one of the symbols `$-$inf' or
  `$-\infty$', which indicate an unbounded value;
  \emphcorr{right} and \emphcorr{top} are floating-point numbers, integers or one of the symbols `inf', `$+$inf',
  `$\infty$' or `$+\infty$', which indicate an unbounded value.
  The symbol `*' indicates a ``don't care'' value, which will match anything.
  \emphcorr{output} is a list of values to return on a successful match.
  The output list can contain the symbol `\$' to indicate the input values or the symbol `\$\$' to
  indicate the offset of the input values from the vector (\emphcorr{left} \emphcorr{bottom}) of the matching range.
  If \emphcorr{left} or \emphcorr{bottom} is unbounded, the corresponding input value is returned rather than the offset.
  
  \objListCmdItem{after}{index list}
  Add a range after the range with the given index.
  The range is in the form: \emphcorr{`*'} or \emphcorr{bracket1 left right bracket2} \emphcorr{`*'} or \emphcorr{bracket3 bottom top bracket4 output}, where
  \emphcorr{bracket1} and \emphcorr{bracket3} are either `[' or `(' and \emphcorr{bracket2} and \emphcorr{bracket4} are
  either `]' or `)';
  \emphcorr{left} and \emphcorr{bottom} are floating-point numbers, integers or one of the symbols `$-$inf' or
  `$-\infty$', which indicate an unbounded value;
  \emphcorr{right} and \emphcorr{top} are floating-point numbers, integers or one of the symbols `inf', `$+$inf',
  `$\infty$' or `$+\infty$', which indicate an unbounded value.
  The symbol `*' indicates a ``don't care'' value, which will match anything.
  \emphcorr{output} is a list of values to return on a successful match.
  The output list can contain the symbol `\$' to indicate the input values or the symbol `\$\$' to
  indicate the offset of the input values from the vector (\emphcorr{left} \emphcorr{bottom}) of the matching range.
  If \emphcorr{left} or \emphcorr{bottom} is unbounded, the corresponding input value is returned rather than the offset.

  \objListCmdItem{\emphcorr{bang}}{}
  Return the previous result, if any, as a list starting with the symbol `result'.

  \objListCmdItem{before}{index list}
  Add a range before the range with the given index.
  The range is in the form: \emphcorr{`*'} or \emphcorr{bracket1 left right bracket2} \emphcorr{`*'} or \emphcorr{bracket3 bottom top bracket4 output}, where
  \emphcorr{bracket1} and \emphcorr{bracket3} are either `[' or `(' and \emphcorr{bracket2} and \emphcorr{bracket4} are
  either `]' or `)';
  \emphcorr{left} and \emphcorr{bottom} are floating-point numbers, integers or one of the symbols `$-$inf' or
  `$-\infty$', which indicate an unbounded value;
  \emphcorr{right} and \emphcorr{top} are floating-point numbers, integers or one of the symbols `inf', `$+$inf',
  `$\infty$' or `$+\infty$', which indicate an unbounded value.
  The symbol `*' indicates a ``don't care'' value, which will match anything.
  \emphcorr{output} is a list of values to return on a successful match.
  The output list can contain the symbol `\$' to indicate the input values or the symbol `\$\$' to
  indicate the offset of the input values from the vector (\emphcorr{left} \emphcorr{bottom}) of the matching range.
  If \emphcorr{left} or \emphcorr{bottom} is unbounded, the corresponding input value is returned rather than the offset.

  \objListCmdItem{clear}{}
  The currently loaded set of ranges is removed.
  
  \objListCmdItem{count}{}
  The number of currently loaded ranges is returned as a two element list, starting with the symbol
  `count'.
  
  \objListCmdItem{delete}{index}
  Removes the range with the given index from the loaded set of ranges.

  \objListCmdItem{dump}{}
  Retrieves all the ranges as a sequence of lists starting with the symbol `range'.
  The second element of each list is the index, and the remainder of the list is in the form
  \emphcorr{`*'} or \emphcorr{bracket1 left right bracket2} \emphcorr{`*'} or \emphcorr{bracket3 bottom top bracket4 output},
  where \emphcorr{bracket1} and \emphcorr{bracket3} are either `[' or `(' and \emphcorr{bracket2} and \emphcorr{bracket4}
  are either `]' or `)'; \emphcorr{left} and \emphcorr{bottom} are floating-point numbers or the symbol `$-$inf',
  which indicates an unbounded value; \emphcorr{right} and \emphcorr{top} are floating-point numbers or
  the symbol `inf', which indicates an unbounded value.
  The symbol `*' indicates a ``don't care'' value, which will match anything.
  \emphcorr{output} is the list of values which will be returned on a successful match.

  \objListCmdItem{\emphcorr{float}\textnormal{/}\emphcorr{integer} \emphcorr{float}\textnormal{/}\emphcorr{integer}}{}
  The given pair of values (either floating-point or integer) is compared to the loaded ranges.
  When a match is found, the output portion of the matching range is returned, prefixed with the symbol
  `result'.
  
  \objListCmdItem{get}{index edge}
  Returns the given edge (`left', `right', `top' or `bottom') of the given index as a two element list,
  starting with the symbol `value'.
  A ``don't care'' value is returned as the symbol `*'.

  \objListCmdItem{load}{filename}
  The currently loaded set of ranges will be set to the contents of the named map file.
  
  \objListCmdItem{replace}{index list}
  Replace the range with the given index.
  The range is in the form: \emphcorr{`*'} or \emphcorr{bracket1 left right bracket2} \emphcorr{`*'} or \emphcorr{bracket3 bottom top bracket4 output}, where
  \emphcorr{bracket1} and \emphcorr{bracket3} are either `[' or `(' and \emphcorr{bracket2} and \emphcorr{bracket4} are
  either `]' or `)';
  \emphcorr{left} and \emphcorr{bottom} are floating-point numbers, integers or one of the symbols `$-$inf' or
  `$-\infty$', which indicate an unbounded value;
  \emphcorr{right} and \emphcorr{top} are floating-point numbers, integers or one of the symbols `inf', `$+$inf',
  `$\infty$' or `$+\infty$', which indicate an unbounded value.
  The symbol `*' indicates a ``don't care'' value, which will match anything.
  \emphcorr{output} is a list of values to return on a successful match.
  The output list can contain the symbol `\$' to indicate the input values or the symbol `\$\$' to
  indicate the offset of the input values from the vector (\emphcorr{left} \emphcorr{bottom}) of the matching range.
  If \emphcorr{left} or \emphcorr{bottom} is unbounded, the corresponding input value is returned rather than the offset.

  \objListCmdItem{set}{index edge value}
  Replace the given edge (`left', `right', `top' or `bottom') of the range with the
  given index.
  \emphcorr{value} is a floating-point number, an integer, or one of the symbols `inf', `$+$inf',
  `$\infty$' or `$+\infty$', `$-$inf' or `$-\infty$', which indicate an unbounded value.
  If \emphcorr{edge} is `left' or `bottom', the symbol `$-$inf' or `$-\infty$' can appear;
  if \emphcorr{edge} is `right' or `top', the symbol `inf', `$+$inf', `$\infty$' or `$+\infty$' can appear.
  Note that a ``don't care'' value cannot be replaced using this command.

  \objListCmdItem{show}{index}
  Retrieves the range with the given index, as a list starting with the symbol `range'.
  The second element of the list is the index, and the remainder of the list is in the form
  \emphcorr{`*'} or \emphcorr{bracket1 left right bracket2} \emphcorr{`*'} or \emphcorr{bracket3 bottom top bracket4 output},
  where \emphcorr{bracket1} and \emphcorr{bracket3} are either `[' or `(' and \emphcorr{bracket2} and \emphcorr{bracket4}
  are either `]' or `)'; \emphcorr{left} and \emphcorr{bottom} are floating-point numbers or the symbol `$-$inf',
  which indicates an unbounded value; \emphcorr{right} and \emphcorr{top} are floating-point numbers or
  the symbol `inf', which indicates an unbounded value.
  The symbol `*' indicates a ``don't care'' value, which will match anything.
  \emphcorr{output} is the list of values which will be returned on a successful match.

  \objListCmdItem{verbose}{\textnormal{[}on\textnormal{/}off\textnormal{]}}
  Range check tracing to the \MaxName{} window will be enabled (`on'), disabled (`off') or reversed,
  if no argument is given.
  
  \objListCmdEnd

\objItemFile[]

\begin{quote}
The map file is composed of a set of ranges.
Comments start with the `\#' character and end with the `;' character.
Ranges are either open (don't include the boundary value) or closed (the boundary value is included),
and have boundary values that are integers, floating-point numbers, or infinities.
An open range is indicated by a parenthesis, or round bracket, and a closed range by a square bracket.
A range declaration is in the following form:

\centerline{\emphcorr{`*'} or \emphcorr{bracket1 left right bracket2} \emphcorr{`*'} or \emphcorr{bracket3 bottom top bracket4 output}}

\emphcorr{bracket1} and \emphcorr{bracket3} are either `[' or `(' and \emphcorr{bracket2} and \emphcorr{bracket4} are
either `]' or `)';
\emphcorr{left} and \emphcorr{bottom} are floating-point numbers, integers or one of the symbols `$-$inf' or
`$-\infty$', which indicate an unbounded value;
\emphcorr{right} and \emphcorr{top} are floating-point numbers, integers or one of the symbols `inf', `$+$inf',
`$\infty$' or `$+\infty$', which indicate an unbounded value.
The symbol `*' indicates a ``don't care'' value, which will match anything.
\emphcorr{output} is a list of values to return on a successful match.
The output list can contain the symbol `\$' to indicate the input values or the symbol `\$\$' to
indicate the offset of the input values from the vector (\emphcorr{left} \emphcorr{bottom}) of the matching range.
The output list can also contain the symbols `\$x' or `\$y' to indicate the first or second input value, or
the symbols `\$\$x' or `\$\$y' to indicate the offset of the first input value from the \emphcorr{left} value of the
matching range or the offset of the second input value from the \emphcorr{bottom} value of the matching range.
If \emphcorr{left} or \emphcorr{bottom} is unbounded, the corresponding input value is returned rather than the offset.
Note that the order of the range declarations is critical---the first range that matches the input
is used, and overlaps between range declarations are ignored.
\end{quote}

\objItemMessage

\objItemComments

\objFileDescription[0.80]{An example map file for a \objNameX{map2d} object}{map2dmap}{
\#File: map\_file\_2d;\\
\# Each line is terminated with a semicolon;\\
\# A comment starts with a '\#' character;\\
\# Note that white space is critical around symbols and operators;\\
\vspace{1ex}
\# Mappings;\\
\# Format: $<$op$>$ $<$left$>$ $<$right$>$ $<$cl$>$ $<$op$>$ $<$bottom$>$ $<$top$>$ $<$cl$>$ $<$output$>$ ;\\
\# where $<$op$>$ is either '[' or '(' and $<$cl$>$ is either ']' or ')';\\
\# $<$left$>$, $<$bottom$>$ are numbers or the symbol '$-\infty$' (option-5) or '$-$inf';\\
\# $<$right$>$, $<$top$>$ are numbers or the symbol '$\infty$' (option-5) or '$+\infty$' or;\\
\# 'inf' or '$+$inf';\\
\# Any of the bracketed pairs can be replaced by the symbol $*$ to indicate;\\
\# a don't care value;\\
\# $<$output$>$ is what to return on a match;\\
\# $<$output$>$ can contain the symbol '\$' which is replaced by the input vector;\\
\# or the symbol '\$\$' which is replaced by the offset of the input vector from;\\
\# the vector ($<$left$>$ $<$bottom$>$) - the input value is returned instead of the;\\
\# offset for any elements of the vector that are unbounded;\\

{[ -20 20 ]} [ -20 20 ] alpha \$ ;\\
( 20 30 ) ( 20 30 ) beta ;\\
{[ 20 30 ]} [ 20 30 ] beta-shadow \$\$ ;\\
( -40 40 ) ( $-\infty$ 0 ) gamma ;\\}

\objDiagram{map2drails.ps}{map2drails}{Syntax diagram for 2-D map files}

\objEnd{\objNameE{map2d}}

% $Log: map2d.tex,v $
% Revision 1.4  2005/08/02 15:07:09  churchoflambda
% Added CVS tags; add rail diagrams for pfsm, map1d, map2d, map3d and listen.
%
