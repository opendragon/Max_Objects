\ProvidesFile{map1d.tex}[v1.0.6]
\startObject{\objNameS{map1d}}{map1d}
\index{Themes!Programming~aids!map1d}
\objPicture{map1dsymbol.ps}
\objItemDescription{\objNameD{map1d} maps its input to one of a sequence of ranges and
returns the set of values associated with the range.}

\objItemCreated{November 2000}

\objItemVersion{1.0.6}

\objItemHelp{yes}

\objItemTheme{Programming aids}

\objItemClass{Arith/Logic/Bitwise, Lists}

\objItemArgs{\nothing}

  \objListArgBegin
  \objListArgItem{init-file}{(optional) symbol}{the name of the map file to load initially}
  \objListArgEnd

\objItemInlet{\nothing}

  \objListIOBegin
  \objListIOItem{integer\textnormal{/}float}{the command or data input}
  \objListIOEnd

\objItemOutlet{\nothing}

  \objListIOBegin
  \objListIOItem{list}{the retrieved data, the previous result (if a \objCmdQ{bang} is received),
  the number of loaded ranges, the description of an individual range or the value of an element
  of a range.
  Results or retrieved data appear as a list starting with the symbol `result';
  the number of loaded ranges appear as a two element list, starting with the symbol `count',
  range descriptions appear as a list starting with the symbol `range' and range element values
  appear as a list starting with the symbol `value'.}
  \objListIOEnd

\objItemCompanion{none}

\objItemStandalone{yes}

\objItemRetainsState{yes}

\objItemCompatibility{\MaxName{} 3.x and \MaxName{} 4.x \{OS 9 and OS X\}}

\objItemFat{Fat}

\objItemCommands[]

  \objListCmdBegin

  \objListCmdItem{add}{list}
  Add a range to the end of the loaded set of ranges.
  The range is in the form: \emphcorr{`*'} or \emphcorr{left-bracket lower-value upper-value right-bracket output}, where
  \emphcorr{left-bracket} is either `[' or `(' and \emphcorr{right-bracket} is either `]' or `)';
  \emphcorr{lower-value} is a floating-point number, an integer or one of the symbols `$-$inf' or
  `$-\infty$', which indicate an unbounded value;
  \emphcorr{upper-value} is a floating-point number, an integer or one of the symbols
  `inf', `$+$inf', `$\infty$' or `$+\infty$', which indicate an unbounded value.
  The symbol `*' indicates a ``don't care'' value, which will match anything.
  \emphcorr{output} is a list of values to return on a successful match.
  The output list can contain the symbol `\$' to indicate the input or the symbol `\$\$' to
  indicate the offset of the input from the \emphcorr{lower-value} of the matching range.
  If the \emphcorr{lower-value} is unbounded, the input is returned rather than the offset.
  
  \objListCmdItem{after}{index list}
  Add a range after the range with the given index.
  The range is in the form: \emphcorr{`*'} or \emphcorr{left-bracket lower-value upper-value right-bracket output}, where
  \emphcorr{left-bracket} is either `[' or `(' and \emphcorr{right-bracket} is either `]' or `)';
  \emphcorr{lower-value} is a floating-point number, an integer or one of the symbols `$-$inf' or
  `$-\infty$', which indicate an unbounded value;
  \emphcorr{upper-value} is a floating-point number, an integer or one of the symbols
  `inf', `$+$inf', `$\infty$' or `$+\infty$', which indicate an unbounded value.
  The symbol `*' indicates a ``don't care'' value, which will match anything.
  \emphcorr{output} is a list of values to return on a successful match.
  The output list can contain the symbol `\$' to indicate the input or the symbol `\$\$' to
  indicate the offset of the input from the \emphcorr{lower-value} of the matching range.
  If the \emphcorr{lower-value} is unbounded, the input is returned rather than the offset.

  \objListCmdItem{\emphcorr{bang}}{}
  Return the previous result, if any, as a list starting with the symbol `result'.

  \objListCmdItem{before}{index list}
  Add a range before the range with the given index.
  The range is in the form: \emphcorr{`*'} or \emphcorr{left-bracket lower-value upper-value right-bracket output}, where
  \emphcorr{left-bracket} is either `[' or `(' and \emphcorr{right-bracket} is either `]' or `)';
  \emphcorr{lower-value} is a floating-point number, an integer or one of the symbols `$-$inf' or
  `$-\infty$', which indicate an unbounded value;
  \emphcorr{upper-value} is a floating-point number, an integer or one of the symbols
  `inf', `$+$inf', `$\infty$' or `$+\infty$', which indicate an unbounded value.
  The symbol `*' indicates a ``don't care'' value, which will match anything.
  \emphcorr{output} is a list of values to return on a successful match.
  The output list can contain the symbol `\$' to indicate the input or the symbol `\$\$' to
  indicate the offset of the input from the \emphcorr{lower-value} of the matching range.
  If the \emphcorr{lower-value} is unbounded, the input is returned rather than the offset.

  \objListCmdItem{clear}{}
  The currently loaded set of ranges is removed.
  
  \objListCmdItem{count}{}
  The number of currently loaded ranges is returned as a two element list, starting with the symbol
  `count'.
  
  \objListCmdItem{delete}{index}
  Removes the range with the given index from the loaded set of ranges.

  \objListCmdItem{dump}{}
  Retrieves all the ranges as a sequence of lists starting with the symbol `range'.
  The second element of each list is the index, and the remainder of the list is in the form
  \emphcorr{`*'} or \emphcorr{left-bracket lower-value upper-value right-bracket output}, where \emphcorr{left-bracket}
  is either `[' or `(' and \emphcorr{right-bracket} is either `]' or `)';
  \emphcorr{lower-value} is a floating-point number or the symbol `$-$inf',
  which indicates an unbounded value; \emphcorr{upper-value}, is a floating-point number or
  the symbol `inf', which indicates an unbounded value.
  The symbol `*' indicates a ``don't care'' value, which will match anything.
  \emphcorr{output} is the list of values which will be returned on a successful match.

  \objListCmdItem{\emphcorr{float}}{}
  The given value is compared to the loaded ranges.
  When a match is found, the output portion of the matching range is returned, prefixed with the symbol
  `result'.
  
  \objListCmdItem{get}{index edge}
  Returns the given edge (`upper' or `lower') of the given index as a two element list,
  starting with the symbol `value'.
  A ``don't care'' value is returned as the symbol `*'.

  \objListCmdItem{\emphcorr{integer}}{}
  The given value is compared to the loaded ranges.
  When a match is found, the output portion of the matching range is returned, prefixed with the symbol
  `result'.
  
  \objListCmdItem{load}{filename}
  The currently loaded set of ranges will be set to the contents of the named map file.
 
  \objListCmdItem{replace}{index list}
  Replace the range with the given index.
  The range is in the form: \emphcorr{`*'} or \emphcorr{left-bracket lower-value upper-value right-bracket output}, where
  \emphcorr{left-bracket} is either `[' or `(' and \emphcorr{right-bracket} is either `]' or `)';
  \emphcorr{lower-value} is a floating-point number, an integer or one of the symbols `$-$inf' or
  `$-\infty$', which indicate an unbounded value;
  \emphcorr{upper-value} is a floating-point number, an integer or one of the symbols
  `inf', `$+$inf', `$\infty$' or `$+\infty$', which indicate an unbounded value.
  The symbol `*' indicates a ``don't care'' value, which will match anything.
  \emphcorr{output} is a list of values to return on a successful match.
  The output list can contain the symbol `\$' to indicate the input or the symbol `\$\$' to
  indicate the offset of the input from the \emphcorr{lower-value} of the matching range.
  If the \emphcorr{lower-value} is unbounded, the input is returned rather than the offset.

  \objListCmdItem{set}{index edge value}
  Replace the given edge (`lower' or `upper') of the range with the given index.
  \emphcorr{value} is a floating-point number, an integer, or one of the symbols `inf', `$+$inf',
  `$\infty$' or `$+\infty$', `$-$inf' or `$-\infty$', which indicate an unbounded value.
  If \emphcorr{edge} is `lower', the symbol `$-$inf' or `$-\infty$' can appear;
  if \emphcorr{edge} is `upper', the symbol `inf', `$+$inf', `$\infty$' or `$+\infty$' can appear.
  Note that a ``don't care'' value cannot be replaced using this command.

  \objListCmdItem{show}{index}
  Retrieves the range with the given index, as a list starting with the symbol `range'.
  The second element of the list is the index, and the remainder of the list is in the form
  \emphcorr{`*'} or \emphcorr{left-bracket lower-value upper-value right-bracket output}, where \emphcorr{left-bracket}
  is either `[' or `(' and \emphcorr{right-bracket} is either `]' or `)';
  \emphcorr{lower-value} is a floating-point number or the symbol `$-$inf',
  which indicates an unbounded value; \emphcorr{upper-value}, is a floating-point number or
  the symbol `inf', which indicates an unbounded value.
  The symbol `*' indicates a ``don't care'' value, which will match anything.
  \emphcorr{output} is the list of values which will be returned on a successful match.

  \objListCmdItem{verbose}{\textnormal{[}on\textnormal{/}off\textnormal{]}}
  Range check tracing to the \MaxName{} window will be enabled (`on'), disabled (`off') or reversed,
  if no argument is given.
  
  \objListCmdEnd

\objItemFile[]

\begin{quote}
The map file is composed of a set of ranges.
Comments start with the `\#' character and end with the `;' character.
Ranges are either open (don't include the boundary value) or closed (the boundary value is included),
and have boundary values that are integers, floating-point numbers, or infinities.
An open range is indicated by a parenthesis, or round bracket, and a closed range by a square bracket.
A range declaration is in the following form:

\centerline{\emphcorr{`*'} or \emphcorr{left-bracket lower-value upper-value right-bracket output}}

\emphcorr{left-bracket} is either `[' or `(' and \emphcorr{right-bracket} is either `]' or `)';
\emphcorr{lower-value} is a floating-point number, an integer or one of the symbols `$-$inf' or
`$-\infty$', which indicate an unbounded value;
\emphcorr{upper-value} is a floating-point number, an integer or one of the symbols
`inf', `$+$inf', `$\infty$' or `$+\infty$', which indicate an unbounded value.
The symbol `*' indicates a ``don't care'' value, which will match anything.
\emphcorr{output} is a list of values to return on a successful match.
The output list can contain the symbols `\$' or `\$x' to indicate the input or the symbol `\$\$'
or `\$\$x' to indicate the offset of the input from the \emphcorr{lower-value} of the matching range.
If the \emphcorr{lower-value} is unbounded, the input is returned rather than the offset.
Note that the order of the range declarations is critical---the first range that matches the input
is used, and overlaps between range declarations are ignored.
\end{quote}

\objItemMessage

\objItemComments

\objFileDescription[0.75]{An example map file for a \objNameX{map1d} object}{map1dmap}{
\#File: map\_file\_1d;\\
\# Each line is terminated with a semicolon;\\
\# A comment starts with a '\#' character;\\
\# Note that white space is critical around symbols and operators;\\

\# Mappings;\\
\# The format is: $<$open$>$ $<$lower$>$ $<$upper$>$ $<$close$>$ $<$output$>$ ;\\
\# where $<$open$>$ is either '[' or '(' and $<$close$>$ is either ']' or ')';\\
\# $<$lower$>$ is a number or the symbol '$-\infty$' (option-5) or '$-$inf';\\
\# $<$upper$>$ is a number or the symbol '$\infty$' (option-5) or '$+\infty$' or;\\
\# 'inf' or '$+$inf';\\
\# The bracketed pair can be replaced by the symbol $*$ to indicate;\\
\# a don't care value;\\
\# $<$output$>$ is what to return on a match;\\
\# <output> can contain the symbol '\$' which is replaced by the input;\\
\# value or the symbol '\$\$' which is replaced by the offset of the input;\\
\# value from $<$lower$>$ - the input value is returned instead of the;\\
\# offset if $<$lower$>$ is unbounded;\\

{[ -20 20 ]} alpha \$ ;\\
( 20 30 ] beta ;\\
( $-\infty$ -20 ) gamma ;\\
( 30 inf ) delta \$\$ ;\\}

\objDiagram{map1drails.ps}{map1drails}{Syntax diagram for 1-D map files}

\objEnd{\objNameE{map1d}}

% $Log: map1d.tex,v $
% Revision 1.6  2006/07/20 04:47:52  churchoflambda
% Re-added the files to record their changes.
%
% Revision 1.4  2005/08/02 15:07:09  churchoflambda
% Added CVS tags; add rail diagrams for pfsm, map1d, map2d, map3d and listen.
%

